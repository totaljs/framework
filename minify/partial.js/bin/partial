#!/usr/bin/env node

// Copyright 2012-2014 (c) Peter Å irka <petersirka@gmail.com>
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

var exec=require("child_process").exec;var fs=require("fs");var path=require("path");var os=require("os");var EOF=os.platform()==="win32"?"\r\n":"\n";var $type=0;function createDirectory(directory){var arr=[];arr.push("controllers");if($type<2){arr.push("views");arr.push("templates");arr.push("databases");arr.push("definitions");if($type==0){arr.push("workers");arr.push("tests");arr.push("contents");arr.push("logs");arr.push("modules")}arr.push("resources");arr.push("public");arr.push("tmp")}arr.forEach(function(o){var dir=path.join(directory,o);if(!fs.existsSync(dir))fs.mkdirSync(dir)})}function createFiles(directory){createFileIndex(directory);createFileConfig(directory);if($type<2){createFileViews(directory);createFileResource(directory);createFilePublic(directory)}if($type===0){createFileTest(directory);createFileModules(directory)}createFileController(directory);createFileDebugging(directory)}function createFileIndex(directory){var buffer=[];buffer.push("var framework = require('partial.js');");buffer.push("var http = require('http');");buffer.push("");buffer.push("var port = parseInt(process.argv[2] || '8000', 10);");buffer.push("var debug = true;");buffer.push("");buffer.push("framework.run(http, debug, port);");buffer.push("");buffer.push("// framework.test(true);");buffer.push("");buffer.push("console.log('http://{0}:{1}/'.format(framework.ip, framework.port));");fs.writeFileSync(path.join(directory,"index.js"),buffer.join(EOF))}function createFileConfig(directory){var buffer=[];buffer.push("name               : my web site");buffer.push("version            : 1.01");buffer.push("secret             : your-secret-key");buffer.push("author             : Your company name");fs.writeFileSync(path.join(directory,"config-release"),buffer.join(EOF));fs.writeFileSync(path.join(directory,"config-debug"),buffer.join(EOF).replace(/true/g,"false"))}function createFileViews(directory){var buffer=[];var dir=path.join(directory,"views");if(!fs.existsSync(dir))fs.mkdirSync(dir);buffer.push("@{meta('title', 'description', 'keywords')}");buffer.push("");buffer.push("<div>Hello world!</div>");fs.writeFileSync(path.join(dir,"homepage.html"),buffer.join("\n"));buffer=[];buffer.push("<!DOCTYPE html>");buffer.push("<html>");buffer.push("<head>");buffer.push("    @{meta}");buffer.push('    <meta charset="utf-8" />');buffer.push('    <meta http-equiv="X-UA-Compatible" content="IE=10" />');buffer.push('    <meta name="format-detection" content="telephone=no" />');buffer.push('    <meta name="viewport" content="width=1024, user-scalable=yes" />');buffer.push('    <meta name="robots" content="all,follow" />');buffer.push("    @{head}");buffer.push("    @{css('default.css')}");buffer.push('    <script type="text/javascript" src="//code.jquery.com/jquery-2.0.3.min.js"></script>');buffer.push("    @{js('default.js')}");buffer.push("    @{favicon('favicon.ico')}");buffer.push("</head>");buffer.push("<body>");buffer.push("");buffer.push("    @{body}");buffer.push("");buffer.push("</body>");buffer.push("</html>");fs.writeFileSync(path.join(dir,"_layout.html"),buffer.join(EOF))}function createFileResource(directory){var dir=path.join(directory,"resources");fs.writeFileSync(path.join(dir,"default.resource"),"name                : value"+EOF)}function createFilePublic(directory){var dir=path.join(directory,"public");var css=path.join(dir,"css");var js=path.join(dir,"js");var img=path.join(dir,"img");if(!fs.existsSync(js))fs.mkdirSync(js);if(!fs.existsSync(css))fs.mkdirSync(css);if(!fs.existsSync(img))fs.mkdirSync(img);var buffer=[];buffer.push("User-agent: *");buffer.push("Allow: /");buffer.push("");fs.writeFileSync(path.join(dir,"robots.txt"),buffer.join(EOF));buffer=[];buffer.push("@#auto-vendor-prefix#@");buffer.push("");buffer.push("@constant{ color:#505050 }");buffer.push("@function(property){ color:@property }");buffer.push("");buffer.push("body { padding:20px; margin:0; font:normal 12px Arial; @constant; }");buffer.push("div { @function('red'); }");fs.writeFileSync(path.join(css,"default.css"),buffer.join(EOF));buffer=[];buffer.push("$(document).ready(function() {");buffer.push("");buffer.push("});");fs.writeFileSync(path.join(dir,"favicon.ico"),"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","base64");fs.writeFileSync(path.join(js,"default.js"),buffer.join(EOF))}function createFileModules(directory){var dir=path.join(directory,"modules");var buffer=[];buffer.push("exports.yourcode = function () {");buffer.push("    return 'Hello World';");buffer.push("};");fs.writeFileSync(path.join(dir,"yourcode.js"),buffer.join(EOF))}function createFileController(directory){var dir=path.join(directory,"controllers");var buffer=[];buffer.push("exports.install = function(framework) {");buffer.push("    framework.route('/', view_homepage);");buffer.push("    framework.route('#400', error400);");buffer.push("    framework.route('#401', error401);");buffer.push("    framework.route('#403', error403);");buffer.push("    framework.route('#404', error404);");buffer.push("    framework.route('#408', error408);");buffer.push("    framework.route('#431', error431);");buffer.push("    framework.route('#500', error500);");buffer.push("};");buffer.push("");buffer.push("/*");buffer.push("exports.models = function() {");buffer.push("");buffer.push("};");buffer.push("*/");buffer.push("");buffer.push("/*");buffer.push("exports.functions = function() {");buffer.push("");buffer.push("};");buffer.push("*/");buffer.push("");buffer.push("// Bad Request");buffer.push("function error400() {");buffer.push("    var self = this;");buffer.push("    self.status = 400;");buffer.push("    self.plain(utils.httpStatus(self.status));");buffer.push("}");buffer.push("");buffer.push("// Unauthorized");buffer.push("function error401() {");buffer.push("    var self = this;");buffer.push("    self.status = 401;");buffer.push("    self.plain(utils.httpStatus(self.status));");buffer.push("}");buffer.push("");buffer.push("// Forbidden");buffer.push("function error403() {");buffer.push("    var self = this;");buffer.push("    self.status = 403;");buffer.push("    self.plain(utils.httpStatus(self.status));");buffer.push("}");buffer.push("");buffer.push("// Not Found");buffer.push("function error404() {");buffer.push("    var self = this;");buffer.push("    self.status = 404;");buffer.push("    self.plain(utils.httpStatus(self.status));");buffer.push("}");buffer.push("");buffer.push("// Request Timeout");buffer.push("function error408() {");buffer.push("    var self = this;");buffer.push("    self.status = 408;");buffer.push("    self.plain(utils.httpStatus(self.status));");buffer.push("}");buffer.push("");buffer.push("// Request Header Fields Too Large");buffer.push("function error431() {");buffer.push("    var self = this;");buffer.push("    self.status = 431;");buffer.push("    self.plain(utils.httpStatus(self.status));");buffer.push("}");buffer.push("");buffer.push("// Internal Server Error");buffer.push("function error500() {");buffer.push("    var self = this;");buffer.push("    self.status = 500;");buffer.push("    self.plain(utils.httpStatus(self.status));");buffer.push("}");buffer.push("");buffer.push("function view_homepage() {");buffer.push("    var self = this;");if($type!==2)buffer.push("    self.view('homepage');");else buffer.push("    self.plain('homepage');");buffer.push("}");fs.writeFileSync(path.join(dir,"default.js"),buffer.join(EOF))}function createFileTest(directory){var dir=path.join(directory,"tests");var buffer=[];buffer.push("var assert = require('assert');");buffer.push("var utils = require('partial.js/utils');");buffer.push("");buffer.push("exports.run = function(framework) {");buffer.push("");buffer.push("    framework.assert('Homepage', '/1/', function response(error, data, name, code, headers) {");buffer.push("        assert.ok(code === 200, name);");buffer.push("    });");buffer.push("");buffer.push("};");fs.writeFileSync(path.join(dir,"global.js"),buffer.join(EOF))}function createFileDebugging(directory){fs.writeFileSync(path.join(directory,"debugging.js"),"Ly8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQovLyBJTVBPUlRBTlQ6IG9ubHkgZm9yIGRlYnVnZ2luZyBtb2RlDQovLyBwYXJ0aWFsLmpzIC0gd2ViIGFwcGxpY2F0aW9uIGZyYW1ld29yayBmb3Igbm9kZS5qcw0KLy8gaHR0cDovL3d3dy5wYXJ0aWFsanMuY29tDQovLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCg0KdmFyIGZvcms9cmVxdWlyZSgiY2hpbGRfcHJvY2VzcyIpLmZvcms7dmFyIGZzPXJlcXVpcmUoImZzIik7dmFyIHBhdGg9cmVxdWlyZSgicGF0aCIpO3ZhciBkaXJlY3Rvcnk9cHJvY2Vzcy5jd2QoKTt2YXIgdXRpbHM9cmVxdWlyZSgicGFydGlhbC5qcy91dGlscyIpO3ZhciBkaXJlY3Rvcmllcz1bZGlyZWN0b3J5KyIvY29udHJvbGxlcnMiLGRpcmVjdG9yeSsiL2RlZmluaXRpb25zIixkaXJlY3RvcnkrIi9tb2R1bGVzIixkaXJlY3RvcnkrIi9yZXNvdXJjZXMiXTt2YXIgZmlsZXM9e307dmFyIGZvcmNlPWZhbHNlO3ZhciBjaGFuZ2VzPVtdO3ZhciBhcHA9bnVsbDt2YXIgc3RhdHVzPTA7dmFyIGFzeW5jPW5ldyB1dGlscy5Bc3luYzt2YXIgcGlkPSIiO3ZhciBwaWRJbnRlcnZhbD1udWxsO3ZhciBwcmVmaXg9Ii0tLS0tLS0tLS0tLT4gIjt2YXIgaXNMb2FkZWQ9ZmFsc2U7ZnVuY3Rpb24gb25GaWx0ZXIocGF0aCxpc0RpcmVjdG9yeSl7cmV0dXJuIGlzRGlyZWN0b3J5P3RydWU6cGF0aC5pbmRleE9mKCIuanMiKSE9PS0xfHxwYXRoLmluZGV4T2YoIi5yZXNvdXJjZSIpIT09LTF9ZnVuY3Rpb24gb25Db21wbGV0ZSgpe3ZhciBzZWxmPXRoaXM7ZnMucmVhZGRpcihkaXJlY3RvcnksZnVuY3Rpb24oZXJyLGFycil7dmFyIGxlbmd0aD1hcnIubGVuZ3RoO2Zvcih2YXIgaT0wO2k8bGVuZ3RoO2krKyl7dmFyIG5hbWU9YXJyW2ldO2lmKG5hbWU9PT0iZGVidWdnaW5nLmpzInx8bmFtZT09PSJrZWVwYWxpdmUuanMiKWNvbnRpbnVlO2lmKG5hbWU9PT0iY29uZmlnLWRlYnVnInx8bmFtZT09PSJjb25maWctcmVsZWFzZSJ8fG5hbWU9PT0idmVyc2lvbnMifHxuYW1lLmluZGV4T2YoIi5qcyIpIT09LTF8fG5hbWUuaW5kZXhPZigiLnJlc291cmNlIikhPT0tMSlzZWxmLmZpbGUucHVzaChuYW1lKX1sZW5ndGg9c2VsZi5maWxlLmxlbmd0aDtmb3IodmFyIGk9MDtpPGxlbmd0aDtpKyspe3ZhciBuYW1lPXNlbGYuZmlsZVtpXTtpZighZmlsZXNbbmFtZV0pZmlsZXNbbmFtZV09aXNMb2FkZWQ/MDpudWxsfXJlZnJlc2goKX0pfWZ1bmN0aW9uIHJlZnJlc2goKXt2YXIgZmlsZW5hbWVzPU9iamVjdC5rZXlzKGZpbGVzKTt2YXIgbGVuZ3RoPWZpbGVuYW1lcy5sZW5ndGg7Zm9yKHZhciBpPTA7aTxsZW5ndGg7aSsrKXt2YXIgZmlsZW5hbWU9ZmlsZW5hbWVzW2ldOyhmdW5jdGlvbihmaWxlbmFtZSl7YXN5bmMuYXdhaXQoZnVuY3Rpb24obmV4dCl7ZnMuc3RhdChmaWxlbmFtZSxmdW5jdGlvbihlcnIsc3RhdCl7aWYoIWVycil7dmFyIHRpY2tzPXN0YXQubXRpbWUuZ2V0VGltZSgpO2lmKGZpbGVzW2ZpbGVuYW1lXSE9PW51bGwmJmZpbGVzW2ZpbGVuYW1lXSE9PXRpY2tzKXtjaGFuZ2VzLnB1c2gocHJlZml4K2ZpbGVuYW1lLnJlcGxhY2UoZGlyZWN0b3J5LCIiKSsoZmlsZXNbZmlsZW5hbWVdPT09MD8iIChhZGRlZCkiOiIgKG1vZGlmaWVkKSIpKTtmb3JjZT10cnVlfWZpbGVzW2ZpbGVuYW1lXT10aWNrc31lbHNle2RlbGV0ZSBmaWxlc1tmaWxlbmFtZV07Y2hhbmdlcy5wdXNoKHByZWZpeCtmaWxlbmFtZS5yZXBsYWNlKGRpcmVjdG9yeSwiIikrIiAocmVtb3ZlZCkiKTtmb3JjZT10cnVlfW5leHQoKX0pfSl9KShmaWxlbmFtZSl9YXN5bmMuY29tcGxldGUoZnVuY3Rpb24oKXtpc0xvYWRlZD10cnVlO3NldFRpbWVvdXQocmVmcmVzaF9kaXJlY3RvcnksMmUzKTtpZihzdGF0dXMhPT0xKXJldHVybjtpZighZm9yY2UpcmV0dXJuO3Jlc3RhcnQoKTt2YXIgbGVuZ3RoPWNoYW5nZXMubGVuZ3RoO2Zvcih2YXIgaT0wO2k8bGVuZ3RoO2krKyljb25zb2xlLmxvZyhjaGFuZ2VzW2ldKTtjaGFuZ2VzPVtdO2ZvcmNlPWZhbHNlfSl9ZnVuY3Rpb24gcmVmcmVzaF9kaXJlY3RvcnkoKXt1dGlscy5scyhkaXJlY3RvcmllcyxvbkNvbXBsZXRlLG9uRmlsdGVyKX1mdW5jdGlvbiByZXN0YXJ0KCl7aWYoYXBwIT09bnVsbCl7dHJ5e3Byb2Nlc3Mua2lsbChhcHAucGlkKX1jYXRjaChlcnIpe31hcHA9bnVsbH1hcHA9Zm9yayhwYXRoLmpvaW4oZGlyZWN0b3J5LCJpbmRleC5qcyIpKTthcHAub24oIm1lc3NhZ2UiLGZ1bmN0aW9uKG1zZyl7aWYobXNnLnN1YnN0cmluZygwLDUpPT09Im5hbWU6Iil7cHJvY2Vzcy50aXRsZT0iZGVidWc6ICIrbXNnLnN1YnN0cmluZyg2KTtyZXR1cm59fSk7YXBwLm9uKCJleGl0IixmdW5jdGlvbigpe2lmKHN0YXR1cyE9PTI1NSlyZXR1cm47YXBwPW51bGx9KTtzdGF0dXM9MX1wcm9jZXNzLm9uKCJTSUdURVJNIixmdW5jdGlvbigpe2ZzLnVubGluayhwaWQsbm9vcCk7aWYoYXBwPT09bnVsbCl7cHJvY2Vzcy5leGl0KDApO3JldHVybn1wcm9jZXNzLmtpbGwoYXBwLnBpZCk7YXBwPW51bGw7cHJvY2Vzcy5leGl0KDApfSk7cHJvY2Vzcy5vbigiU0lHSU5UIixmdW5jdGlvbigpe2ZzLnVubGluayhwaWQsbm9vcCk7aWYoYXBwPT09bnVsbCl7cHJvY2Vzcy5leGl0KDApO3JldHVybn1wcm9jZXNzLmtpbGwoYXBwLnBpZCk7YXBwPW51bGw7cHJvY2Vzcy5leGl0KDApfSk7cHJvY2Vzcy5vbigiZXhpdCIsZnVuY3Rpb24oKXtmcy51bmxpbmsocGlkLG5vb3ApO2lmKGFwcD09PW51bGwpcmV0dXJuO3Byb2Nlc3Mua2lsbChhcHAucGlkKTthcHA9bnVsbH0pO2Z1bmN0aW9uIG5vb3AoKXt9aWYocHJvY2Vzcy5waWQ+MCl7Y29uc29sZS5sb2cocHJlZml4KyJQSUQ6ICIrcHJvY2Vzcy5waWQpO3BpZD1wYXRoLmpvaW4oZGlyZWN0b3J5LCJkZWJ1Z2dpbmcucGlkIik7ZnMud3JpdGVGaWxlU3luYyhwaWQscHJvY2Vzcy5waWQpO3BpZEludGVydmFsPXNldEludGVydmFsKGZ1bmN0aW9uKCl7ZnMuZXhpc3RzKHBpZCxmdW5jdGlvbihleGlzdCl7aWYoZXhpc3QpcmV0dXJuO2ZzLnVubGluayhwaWQsbm9vcCk7aWYoYXBwIT09bnVsbClwcm9jZXNzLmtpbGwoYXBwLnBpZCk7cHJvY2Vzcy5leGl0KDApfSl9LDJlMyl9cmVzdGFydCgpO3JlZnJlc2hfZGlyZWN0b3J5KCk7","base64")}function install(directory){exec("npm install partial.js",{cwd:directory},function(error,stdout,stderr){}).on("exit",function(){console.log("partial.js: success")})}function display_help(){console.log("");console.log("-m or -minimal   = minimal");console.log("-n or -normal    = normal");console.log("-f or -full      = full (default)");console.log("-v or -version   = partial.js version");console.log("/path/           = target (default current directory)");console.log("")}function main(){var dir=process.cwd();for(var i=2;i<process.argv.length;i++){var arg=process.argv[i];var cmd=arg.toLowerCase();if(cmd==="-v"||cmd==="-version"){console.log(require("partial.js").version);return}if(cmd==="-f"||cmd==="-full")continue;if(cmd==="-m"||cmd==="-minimal"||cmd==="-minimum"){$type=2;continue}if(cmd==="-n"||cmd==="-normal"){$type=1;continue}if(cmd==="-h"||cmd==="-help"){display_help();return}dir=arg;break}if(!fs.existsSync(dir)){console.log("partial.js: error / directory not exists");return}var files=fs.readdirSync(dir);if(files.length>0){var can=true;for(var i=0;i<files.length;i++){var name=files[i];if(name[0]===".")continue;can=false}if(!can){console.log("partial.js: error / directory is not empty");return}}console.log("partial.js: creating directories");createDirectory(dir);console.log("partial.js: creating files");createFiles(dir);console.log("partial.js: installing current version partial.js");install(dir)}main();